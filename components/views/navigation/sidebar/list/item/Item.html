<UiContextMenu
  class="wrapper"
  :class="{ 'is-loading': isLoading}"
  :items="contextMenuValues"
>
  <button
    class="item"
    :class="{ selected: isSelected }"
    data-cy="sidebar-user"
    @click="openConversation"
  >
    <UiUserState
      v-if="conversation.type === 'direct' && user && status"
      :user="user"
      :conversationId="conversationId"
    />
    <UiGroupIcon
      v-else-if="conversation.participants"
      :members="conversation.participants"
    />

    <div class="user-info">
      <div class="row">
        <TypographyText
          class="ellipsis"
          as="h4"
          :color="unreadCount ? 'light' : 'dark'"
          data-cy="sidebar-user-name"
        >
          {{ conversation.name }}
        </TypographyText>

        <TypographyText
          class="timestamp"
          v-if="messages.length"
          color="dark"
          size="xs"
        >
          {{ timestamp }}
        </TypographyText>
      </div>

      <div class="row">
        <TypographyText
          size="sm"
          class="subtitle"
          :color="unreadCount ? 'light' : 'dark'"
          :weight="unreadCount ? 'bold' : ''"
        >
          <div
            ref="subtitle"
            class="ellipsis"
            :class="{ bigmoji: containsOnlyEmoji(lastMessageDisplay) }"
            v-html="subtitle"
          />
        </TypographyText>
        <TypographyTag
          v-if="unreadCount"
          class="tag"
          :text="unreadCount.toString()"
          small
        />
      </div>
    </div>
  </button>

  <div class="loader">
    <UiLoadersSpinner :spinning="isLoading" />
  </div>
</UiContextMenu>
