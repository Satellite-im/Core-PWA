<div id="chatbar" ref="chatbar">
  <Enhancers @click="handleChatTextFromOutside" />
  <!-- Hide commands for early access -->
  <!-- <ChatbarCommandsPreview :recipient="recipient" :message="ui.chatbarContent" /> -->
  <ChatbarReply />
  <FilesUploadError v-if="chat.countError" />
  <FilesUploadPreview v-if="getFiles.length" />
  <div
    class="chatbar-wrap"
    :class="{'is-error': charlimit, 'inactive': !recipient, 'top-corners-sharp': isSharpCorners}"
  >
    <div class="control-wrap file-upload-wrap">
      <FilesUpload ref="upload" />
    </div>
    <div
      :class="`chat-label ${isValidCommand ? 'green' : 'color-danger'}`"
      v-if="hasCommand"
      ref="chatbar"
    >
      <terminal-icon size="1x" />
    </div>
    <ChatbarEditable
      ref="editable"
      v-model="text"
      v-click-outside="hideKeyboard"
      :placeholder="$t('ui.talk')"
      :enabled="Boolean(recipient) && !textile.messageLoading"
      :class="`messageuser ${hasCommand ? 'has-command' : ''}`"
      :focus="ui.chatbarFocus"
      @keydown="handleInputKeydown"
      @paste="handlePaste"
    />
    <ChatbarControls
      id="chatbar-controls"
      :sendMessage="sendMessage"
      :disabled="!recipient || charlimit"
    />
  </div>
  <ChatbarFooter :text="text" :charlimit="charlimit" />
</div>
