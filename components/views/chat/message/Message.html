<UiContextMenu
  class="chat-message-container"
  :class="{ 'show-header': showHeader }"
  :items="contextMenuValues"
>
  <MessageNotice v-if="isNotice" :message="message" />
  <div
    v-else
    class="chat-message"
    :class="{ 'show-header': showHeader, 'is-replying-to': isReplyingTo }"
  >
    <template v-if="showHeader">
      <div class="avatar">
        <UiCircle
          :type="avatarSrc ? 'image' : 'random'"
          :seed="author.did"
          :source="avatarSrc"
        />
      </div>
      <div class="header">
        <span :click="showQuickProfile">
          <UiUserName :username="author.name" />
        </span>
      </div>
    </template>
    <div class="timestamp">{{ timestamp }}</div>
    <div class="body">
      <MessageMarkdown
        v-if="message.body"
        :text="markdownToHtml"
        class="markdown"
        :class="{ bigmoji: containsOnlyEmoji }"
        data-cy="chat-message"
      />
      <MessageAttachments
        v-if="message.attachments.length"
        :attachments="message.attachments"
      />
      <MessageGlyph v-if="message.glyph" :glyph="message.glyph" />
      <span class="status editing" v-if="message.editingAt">
        <UiLoadersSpinner spinning />
      </span>
      <span
        class="status edited"
        data-cy="message-edited"
        v-else-if="message.editedAt"
      >
        ({{$t('ui.edited')}})
      </span>
      <MessageActions
        :setReplyChatbarMessage="setReplyChatbarMessage"
        :emojiReaction="emojiReaction"
        :editMessage="editMessage"
        :message="message"
        :hideReply="hideReplyAction"
      />
    </div>
    <div class="footer">
      <MessageReactions :message="message" :emojiReaction="emojiReaction" />
      <MessageReplies :replies="replies" v-if="replies.length" />
    </div>
  </div>
</UiContextMenu>
