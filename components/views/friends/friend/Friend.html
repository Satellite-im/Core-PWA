<UiContextMenu :items="contextMenuValues" class="friend" data-cy="friend">
  <UiUserState :user="user" :src="src" :showStatus="showStatus" />
  <div class="description">
    <TypographyText
      color="light"
      font="heading"
      weight="bold"
      class="friend-name"
      data-cy="friend-name"
    >
      {{ user.name || user.did }}
    </TypographyText>
    <TypographyText v-if="isPreview" data-cy="friend-did" size="sm">
      {{ user.did }}
    </TypographyText>
    <TypographyText v-if="status" size="sm"> {{ status }} </TypographyText>
  </div>
  <div class="spacer"></div>
  <div class="controls" v-if="user && !request && isPreview">
    <div class="loader-container" v-if="loading">
      <UiLoadersLoadingBar short />
    </div>
    <InteractablesButton
      v-else
      color="success"
      data-cy="friend-send-request"
      v-tooltip.bottom="$t('friends.send')"
      :disabled="loadCheck"
      @click="createFriendRequest"
    >
      <check-icon size="1x" />
    </InteractablesButton>
  </div>
  <div
    class="controls"
    v-if="request && request.incoming && request.status === 'pending'"
  >
    <div class="loader-container" v-if="loading">
      <UiLoadersLoadingBar short />
    </div>
    <InteractablesButton
      v-if="!loading"
      color="danger"
      v-tooltip.bottom="$t('friends.decline')"
      @click="rejectFriendRequest"
    >
      <x-icon size="1x" />
    </InteractablesButton>
    <InteractablesButton
      v-if="!loading"
      color="success"
      v-tooltip.bottom="$t('friends.accept')"
      :disabled="loadCheck"
      @click="acceptFriendRequest"
    >
      <check-icon size="1x" />
    </InteractablesButton>
  </div>
  <div class="controls" v-else-if="blocked">
    <div class="loader-container" v-if="loading">
      <UiLoadersLoadingBar short />
    </div>
    <InteractablesButton
      v-else
      color="danger"
      v-tooltip.bottom="$t('friends.unblock')"
    >
      <x-icon size="1x" />
    </InteractablesButton>
  </div>
  <div
    class="controls"
    v-else-if="request && !request.incoming && request.status === 'pending'"
  >
    <div class="loader-container" v-if="loading">
      <UiLoadersLoadingBar short />
    </div>
    <InteractablesButton
      v-else
      color="danger"
      data-cy="friend-cancel-request-sent"
      v-tooltip.bottom="$t('friends.cancel')"
      :loading="loading"
      @click="cancelRequest"
    >
      <x-icon size="1x" />
    </InteractablesButton>
  </div>
  <div class="controls" v-else-if="user && !request && !isPreview">
    <div class="loader-container" v-if="loading">
      <UiLoadersLoadingBar short />
    </div>
    <InteractablesButton
      v-if="!loading"
      data-cy="friend-send-message"
      v-tooltip.bottom="$t('friends.message')"
      @click="sendMessageRequest"
    >
      <message-square-icon size="1x" />
    </InteractablesButton>
    <!-- TODO: Re-enable after context-menu elements refactor -->
    <!-- <InteractablesButton -->
    <!-- v-if="!loading" -->
    <!-- v-tooltip.bottom="$t('friends.options')" -->
    <!-- > -->
    <!-- <more-vertical-icon size="1x" /> -->
    <!-- </InteractablesButton> -->
  </div>
</UiContextMenu>
